# TNBC_python_scripts

This repo contains working scripts for analyzing the TNBC MIBI data. It is organized as follows:

`data_dir`: This directory contains a cell table (generated with ark and annotated by Pixie). The scripts expect a column named 
`cell_meta_cluster` containing the cell clusters, as well `fov` with the specifc image name. In addition, this directory should also contain metadata
about each fov, each timepoint, and each patient, as appropriate for your study.

Files:
`preprocessing_cell_table_updates.py`: This file takes the cell table generated by Pixie, and transforms it for plotting. Some of this functionality is 
has now been incorporated into notebook 4 in `ark`. Other parts, however, have not yet been put into `ark`, such as aggregating cell populations. 

`preprocessing_metadata.py`: This file transforms the cell table and metadata files for analysis. It creates a simplified cell table
with only the necessary columns for specific plotting tasks, and creates annotations in the metadata files that need to be computed from the
data, such as which patients have data from multiple timepoints

`create_dfs_per_core.py`: This file creates the dfs which will be used for plotting core-level information. It transforms the cell table into
a series of long-format dfs which can be easily used for data visualization. It creates separate dfs for cell population evaluations and functional marker
evaluation

`create_image_masks.py`: This file creates masks for each image based on supplied critieria. It identifies background based on the gold channel, tumor compartments based on ECAD staining patterns, and TLS structures. It then takes these masks, and assigns each cell each image to the mask that it overlaps most with


